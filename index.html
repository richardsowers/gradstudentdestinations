<!DOCTYPE html>

<!DOCTYPE html>
<html>
<head>
  <meta charset='utf-8' />
  <title>Graduate School Destinations</title>
  <meta name='viewport' content='initial-scale=1,maximum-scale=1,user-scalable=no' />
  <script src='https://api.tiles.mapbox.com/mapbox-gl-js/v0.49.0/mapbox-gl.js'></script>
  <link href='https://api.tiles.mapbox.com/mapbox-gl-js/v0.49.0/mapbox-gl.css' rel='stylesheet' />
  <style>
    body { margin:0; padding:0; }
    #map { position:absolute; top:0; bottom:0; width:100%; }
  </style>
</head>
<body>

<div id="map"></div>
<script>
    mapboxgl.accessToken = "pk.eyJ1IjoicmljaGFyZHNvd2VycyIsImEiOiJjams5dnZtcWYya2RxM3FxcW03YzF0a2pzIn0._YTRBqzmI1sZnBONyEBr3A";
    var map = new mapboxgl.Map({
      container: "map",
      style: "mapbox://styles/richardsowers/cjohy2xza0fjt2rpoysqmsrqi",
      center: [-98.5, 40],
      zoom: 3.75
    });

    var data={
        "Newport Beach":{
            path:[[-88.2272, 40.102000000000004], [-89.90081920159538, 39.958884265374955], [-91.56687738892654, 39.79171120369691], [-93.22430210479732, 39.60073737318735], [-94.87207240316528, 39.38625186078466], [-96.50922366786841, 39.14857435751895], [-98.13485170391881, 38.888053090585025], [-99.74811608031582, 38.6050626424459], [-101.34824271938525, 38.30000168744483], [-102.93452574266706, 37.97329067586205], [-104.50632859694798, 37.625369494190814], [-106.06308449585619, 37.25669512871604], [-107.60429622229935, 36.86773935735248], [-109.1295353448285, 36.458986492241564], [-110.63844090673435, 36.03093119291781], [-112.1307176503993, 35.58407636703523], [-113.60613384127105, 35.11893117278046], [-115.06451875597563, 34.636009134272825], [-116.50575989777178, 34.13582637852832], [-117.92979999999999, 33.6189]],
            count:1
        },
        "Chicago":{
            path:[[-88.2272, 40.10199999999999], [-88.19654534774769, 40.19556391623073], [-88.16580615583001, 40.28911868163365], [-88.13498191743945, 40.382664246420106], [-88.10407212219728, 40.476200560457755], [-88.07307625612127, 40.569727573267265], [-88.04199380159291, 40.663245234018916], [-88.0108242373243, 40.756753491529324], [-87.97956703832477, 40.85025229425792], [-87.9482216758671, 40.94374159030354], [-87.91678761745331, 41.03722132740093], [-87.88526432678024, 41.13069145291719], [-87.85365126370463, 41.22415191384828], [-87.82194788420793, 41.31760265681529], [-87.79015364036059, 41.41104362806088], [-87.75826798028622, 41.50447477344556], [-87.7262903481251, 41.59789603844395], [-87.69422018399747, 41.69130736814105], [-87.66205692396636, 41.78470870722834], [-87.6298, 41.878099999999996]],
            count:3
        },
        "Boston":{
            path:[[-88.2272, 40.102000000000004], [-87.35739746361132, 40.28338518591829], [-86.48300891838073, 40.45819357431684], [-85.60415419220519, 40.62635054166438], [-84.72096016421192, 40.78778333711338], [-83.83356070929602, 40.94242121159312], [-82.94209661965256, 41.090195546533245], [-82.0467155027207, 41.23103998172945], [-81.14757165508227, 41.364890541846535], [-80.24482591199367, 41.491685761040664], [-79.33864547237599, 41.61136680517281], [-78.42920369924244, 41.72387759107825], [-77.51667989570383, 41.82916490235473], [-76.60125905685985, 41.92717850113229], [-75.6831315980558, 42.01787123529364], [-74.76249306015724, 42.10119914062271], [-73.83954379266997, 42.17712153737329], [-72.91448861570399, 42.245601120767475], [-71.9875364619501, 42.30660404495617], [-71.0589, 42.3601]],
            count:1
        },
        "Minneapolis":{
            path:[[-88.2272, 40.102000000000004], [-88.47354255639736, 40.36394808873873], [-88.72180142916356, 40.62535947698729], [-88.97200550323309, 40.88622513545361], [-89.22418406792599, 41.14653586828773], [-89.47836682110355, 41.40628230954544], [-89.7345838732063, 41.665454919585706], [-89.99286575116136, 41.924043981400885], [-90.25324340214605, 42.18203959688006], [-90.51574819719337, 42.439431683004536], [-90.78041193462472, 42.69620996797557], [-91.04726684329353, 42.952363987274055], [-91.31634558562365, 43.20788307965206], [-91.58768126042439, 43.4627563830564], [-91.86130740546373, 43.716972830483996], [-92.1372579997801, 43.970521145769816], [-92.4155674657118, 44.22338983930719], [-92.69627067062245, 44.475567203701395], [-92.97940292829925, 44.72704130935704], [-93.265, 44.9778]],
            count:1,
        },
        "Memphis":{
            path:[[-88.2272, 40.102000000000004], [-88.32941474424018, 39.842145955243375], [-88.43086014723923, 39.58219474475132], [-88.53154872085774, 39.32214785710389], [-88.63149274271345, 39.062006753028015], [-88.73070426177367, 38.80177286610567], [-88.82919510379669, 38.5414476034617], [-88.92697687662606, 38.281032346432156], [-89.02406097534272, 38.0205284512136], [-89.12045858727883, 37.75993724949391], [-89.21618069689819, 37.499260049065484], [-89.31123809054642, 37.23849813442109], [-89.40564136107567, 36.97765276733312], [-89.49940091234706, 36.71672518741671], [-89.59252696361482, 36.455716612677215], [-89.68502955379542, 36.19462824004257], [-89.7769185456257, 35.933461245881006], [-89.86820362971244, 35.67221678650459], [-89.9588943284773, 35.41089599865901], [-90.04899999999998, 35.14950000000001]],
            count:1
        },
        "Austin":{
            path:[[-88.2272, 40.102000000000004], [-88.79037684067738, 39.60504202694025], [-89.34552185369552, 39.1053646196055], [-89.89284690392344, 38.6030522544268], [-90.43255958987756, 38.098186711584724], [-90.96486323734096, 37.59084716769229], [-91.48995690634186, 37.08111028636979], [-92.0080354100012, 36.56905030663026], [-92.51928934388435, 36.054739129014294], [-93.02390512460758, 35.53824639943111], [-93.52206503655859, 35.01963959067843], [-94.01394728569178, 34.49898408162782], [-94.49972605945275, 33.97634323407388], [-94.9795715919742, 33.45177846725671], [-95.45365023376587, 32.925349330075456], [-95.92212452519638, 32.3971135710193], [-96.38515327313328, 31.867127205847996], [-96.8428916301709, 31.335444583060408], [-97.29549117593412, 30.802118447193756], [-97.74310000000001, 30.267199999999992]],
            count:1,
        },
        "Portland":{
            path:[[-88.2272, 40.102000000000004], [-89.85640171826631, 40.6328226281082], [-91.5110830539452, 41.14026875478896], [-93.1908985819394, 41.62355536267026], [-94.89537590900802, 42.08190687013895], [-96.62390943810077, 42.514559427609385], [-98.37575520286697, 42.92076550961343], [-100.15002700659679, 43.299798762627326], [-101.94569409566611, 43.650959057428594], [-103.76158058394113, 43.97357768369853], [-105.59636682060473, 44.267022614039625], [-107.44859285903001, 44.530703755106536], [-109.3166641387848, 44.764078095727335], [-111.198859437457, 44.966654656285016], [-113.09334108536058, 45.13799914075795], [-114.99816736668612, 45.27773819310924], [-116.91130695834518, 45.38556316346298], [-118.83065518618018, 45.46123329682975], [-120.75405181121053, 45.5045782679679], [-122.6793, 45.51550000000002]],
            count:1
        },
        "Green Bay":{
            path:[[-88.2272, 40.102], [-88.21665701366712, 40.33423963842308], [-88.20604134934017, 40.56647207369694], [-88.19535190196865, 40.79869728325152], [-88.18458754625473, 41.03091524465995], [-88.17374713616739, 41.26312593563247], [-88.16282950444275, 41.49532933401032], [-88.15183346206997, 41.72752541775913], [-88.14075779776256, 41.959714164962385], [-88.12960127741415, 42.19189555381443], [-88.11836264353863, 42.42406956261337], [-88.10704061469387, 42.656236169753676], [-88.09563388488846, 42.88839535371849], [-88.08414112297105, 43.12054709307183], [-88.07256097200147, 43.35269136645035], [-88.0608920486032, 43.58482815255488], [-88.04913294229632, 43.816957430141755], [-88.03728221481055, 44.04907917801372], [-88.02533839937722, 44.28119337501068], [-88.0133, 44.5133]],
            count:1
        },
        "Peoria":{
            path:[[-88.2272, 40.102], [-88.21665701366712, 40.33423963842308], [-88.20604134934017, 40.56647207369694], [-88.19535190196865, 40.79869728325152], [-88.18458754625473, 41.03091524465995], [-88.17374713616739, 41.26312593563247], [-88.16282950444275, 41.49532933401032], [-88.15183346206997, 41.72752541775913], [-88.14075779776256, 41.959714164962385], [-88.12960127741415, 42.19189555381443], [-88.11836264353863, 42.42406956261337], [-88.10704061469387, 42.656236169753676], [-88.09563388488846, 42.88839535371849], [-88.08414112297105, 43.12054709307183], [-88.07256097200147, 43.35269136645035], [-88.0608920486032, 43.58482815255488], [-88.04913294229632, 43.816957430141755], [-88.03728221481055, 44.04907917801372], [-88.02533839937722, 44.28119337501068], [-88.0133, 44.5133]],
            count:1
        },
        "Basking Ridge":{
            path:[[-88.2272, 40.102000000000004], [-87.51582662628883, 40.17397220038225], [-86.80299167615995, 40.24156401965801], [-86.08878107508129, 40.304756339149435], [-85.3732822874694, 40.363531193639545], [-84.65658422961903, 40.417871794365084], [-83.93877717888452, 40.467762550690246], [-83.21995267930888, 40.51318909039516], [-82.50020344391375, 40.55413827851712], [-81.77962325387912, 40.59059823468604], [-81.05830685485758, 40.62255834889984], [-80.33634985068188, 40.65000929568994], [-79.6138485947375, 40.67294304663194], [-78.89090007928394, 40.691352881161265], [-78.1676018230192, 40.705233395659], [-77.44405175719024, 40.71458051077858], [-76.72034811056065, 40.71939147698948], [-75.99658929355158, 40.71966487831976], [-75.2728737818775, 40.7154006342854], [-74.5493, 40.7066]],
            count:1
        },
        "Racine":{
            path:[[-88.2272, 40.102000000000004], [-88.20468678921029, 40.24017213050894], [-88.18208168193927, 40.3783376578973], [-88.15938385370893, 40.51649654106156], [-88.13659247119672, 40.654648738525495], [-88.11370669211183, 40.79279420843419], [-88.09072566506946, 40.93093290854799], [-88.06764852946289, 41.06906479623636], [-88.0444744153336, 41.20718982847162], [-88.02120244323912, 41.345307961822556], [-87.9978317241187, 41.483419152447944], [-87.97436135915666, 41.62152335609001], [-87.95079043964367, 41.759620528067636], [-87.9271180468354, 41.89771062326964], [-87.90334325180902, 42.03579359614778], [-87.87946511531712, 42.17386940070973], [-87.85548268763924, 42.31193799051186], [-87.83139500843086, 42.449999318652], [-87.80720110656982, 42.58805333776197], [-87.78289999999998, 42.72610000000001]],
            count:1
        }

    };
    var point_feature={
        type: "Feature",
        geometry: {
            type: "Point",
            coordinates: null
        },
        properties: {
            label: null,
        },
    };
    point_feature=JSON.stringify(point_feature);

    line_feature={
        type: "Feature",
        geometry: {
            type: "LineString",
            coordinates: null,
        },
        properties: {
            count:null
        },
    };
    line_feature=JSON.stringify(line_feature);

    var point_layer={
        id: "universities",
        type: "symbol",
        source: {
            type: "geojson",
            data: {
                type: "FeatureCollection",
                features: [],
            }
        },
        layout: {
            "text-field": "{label}",
            "text-font": ["Open Sans Semibold", "Arial Unicode MS Bold"],
            "text-anchor": "top",
            "text-size":20,
            "text-allow-overlap":false,
        },
        paint: {
            "text-color": "red",//#950011"
        },
    };
    var line_layer={
        id: "arrows",
        type: "line",
        source: {
            type: "geojson",
            data:{
                type: "FeatureCollection",
                features: [],
            }
        },
        layout: {
            "line-join": "round",
            "line-cap": "round",
        },
        paint: {
            "line-color": "#0276FD",
            "line-width": { "type": "identity", "property": "count" },
        },
    };

    Object.keys(data).forEach(function(university){
        //console.log(university);
        var path=data[university].path;
        //console.log(JSON.stringify(path));
        var count=data[university].count;
        //console.log(count);
        var endpoint=path.slice(-1)[0];
        //console.log(JSON.stringify(endpoint));

        var p_f=JSON.parse(point_feature);
        p_f.geometry.coordinates=path.slice(-1)[0];
        p_f.properties.label=university;
        point_layer.source.data.features.push(p_f)

        var l_f=JSON.parse(line_feature);
        l_f.geometry.coordinates=path;
        l_f.properties.count=data[university].count;
        //console.log(JSON.stringify(l_f));
        line_layer.source.data.features.push(l_f)
    })
    //console.log(JSON.stringify(point_layer));



map.on('load', function () {
    map.addLayer(line_layer);
    map.addLayer(point_layer);

});
</script>

</body>
</html>